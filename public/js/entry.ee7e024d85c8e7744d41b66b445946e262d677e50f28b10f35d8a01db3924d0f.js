(()=>{(function(){let a=window.FOLKLORE_ENTRY;if(!a)return;let l=document.getElementById("back-to-map"),o=document.getElementById("related-places");if(l){let e=document.referrer,r=(a.base||"/").replace(/\/$/,""),p=r+"/map/";if(e&&e.includes("/map")&&(e.endsWith("/map")||e.endsWith("/map/")))try{let c=new URL(e);c.search&&(l.href=r+"/map/"+c.search||l.href)}catch{}}let d=a.indexUrl||(a.base||"")+"map/index.json";fetch(d,{cache:"default"}).then(function(e){return e.json()}).then(function(e){let r=new Set((a.tags||[]).map(function(t){return String(t).toLowerCase()})),p=a.slug,c=e.filter(function(t){return((t.url||"").split("/").filter(Boolean).pop()||"")!==p}).map(function(t){let n=(t.tags||[]).map(function(u){return String(u).toLowerCase()}),s=0;return n.forEach(function(u){r.has(u)&&s++}),{entry:t,shared:s}}).filter(function(t){return t.shared>0}).sort(function(t,n){return n.shared!==t.shared?n.shared-t.shared:(t.entry.title||"").localeCompare(n.entry.title||"")}).slice(0,6).map(function(t){return t.entry});if(c.length===0){o.innerHTML='<p class="related-none">No related places with shared tags.</p>';return}o.innerHTML='<ul class="related-list" role="list">'+c.map(function(t){let n=(t.tags||[]).slice(0,3).map(function(s){return'<span class="tag-chip tag-chip-small">'+i(s)+"</span>"}).join("");return'<li><a href="'+f(t.url)+'">'+i(t.title)+"</a>"+(t.county?' <span class="related-county">'+i(t.county)+"</span>":"")+(n?' <div class="related-tags">'+n+"</div>":"")+"</li>"}).join("")+"</ul>"}).catch(function(){o.innerHTML='<p class="related-none">Unable to load related places.</p>'});function i(e){let r=document.createElement("div");return r.textContent=e,r.innerHTML}function f(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}})();})();
